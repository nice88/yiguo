{"remainingRequest":"E:\\vue\\yg2\\yiguo\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue\\yg2\\yiguo\\src\\components\\home\\city.vue?vue&type=style&index=0&id=ebe5a98a&scoped=true&lang=css&","dependencies":[{"path":"E:\\vue\\yg2\\yiguo\\src\\components\\home\\city.vue","mtime":1561468854025},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\css-loader\\index.js","mtime":1561468846773},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1561468853343},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\postcss-loader\\src\\index.js","mtime":1561468849645},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1561468846106},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\vue-loader\\lib\\index.js","mtime":1561468853342}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\n#content .city_body{ margin-top: 45px; display: flex; width:100%; position: absolute; top: 0; bottom: 0;}\r\n.city_body .city_list{ flex:1; overflow: auto; }\r\n.city_body .city_list::-webkit-scrollbar{\r\n    background-color:transparent;\r\n    width:0;\r\n}\r\n.clearfix{\r\n    font-size: 13px;\r\n    overflow: hidden;background: #F0F0F0;padding:0 18px;\r\n}\r\n.clearfix li:nth-of-type(3n+2){\r\n  text-align: center;\r\n}\r\n.clearfix li:nth-of-type(3n) span{\r\n    float: right;\r\n}\r\n#selectCity .clearfix {\r\n    margin-top: 0px;\r\n    background: white;\r\n}\r\n.clearfix li span{\r\n    display: inline-block;\r\n    width: 72px;\r\n    height: 27px;\r\n    border: 1px solid #ddd;\r\n    line-height: 27px;\r\n    border-radius: 3px;\r\n    text-align: center;\r\n}\r\n#selectCity .clearfix li span{\r\n     border: none;\r\n}\r\n.city_body .city_hot{ }\r\n.city_body .city_hot h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0; font-weight: normal;}\r\n.city_body .city_hot ul li{ float: left;  width: 33%; height: 33px;border-radius: 3px; line-height: 33px;box-sizing: border-box;}\r\n.city_body .city_sort div{ }\r\n.city_body .city_sort h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0;font-weight: 600;color: #385c9a;}\r\n.city_body .city_sort ul{  margin-top: 10px;}\r\n.city_body .city_sort ul li{ line-height: 30px; line-height: 30px;font-size: 13px;   }\r\n.city_body .city_index{ width:20px; display: flex; flex-direction:column; justify-content:center; text-align: center; border-left:1px #e6e6e6 solid;}\r\n",{"version":3,"sources":["city.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"city.vue","sourceRoot":"src/components/home","sourcesContent":["<template>\r\n    <div class=\"city_body\">\r\n        <!-- <div class=\"city_list\">\r\n            <div class=\"city_hot\">\r\n                <h2>热门城市</h2>\r\n                <ul class=\"clearfix\">\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"city_sort city_hot selectCity\" id=\"selectCity\">\r\n                <div>\r\n                    <h2>A</h2>\r\n                    <ul class=\"clearfix\">\r\n                        <li><span>阿拉善盟</span></li>\r\n                        <li><span>鞍山</span></li>\r\n                        <li><span>安庆</span></li>\r\n                        <li><span>安阳</span></li>\r\n                    </ul>\r\n                </div>\t\r\n            </div>\r\n        </div> -->\r\n        <!-- <div class=\"city_index\">\r\n            <ul>\r\n                <li>A</li>\r\n                <li>B</li>\r\n                <li>C</li>\r\n                <li>D</li>\r\n                <li>E</li>\r\n            </ul>\r\n        </div> -->\r\n   \r\n        <div class=\"city_list\">\r\n            <Loading v-if=\"isLoading\" />\r\n         \r\n                <div>\r\n                    <div class=\"city_hot\">\r\n                        <h2>热门城市</h2>\r\n                        <ul class=\"clearfix\">\r\n                            <li v-for=\"item in hotList\" :key=\"item.id\" @tap=\"handleToCity(item.nm , item.id)\"><span>{{ item.nm }}</span></li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class=\"city_sort city_hot selectCity\" id=\"selectCity\" ref=\"city_sort\">\r\n                        <div v-for=\"item in cityList\" :key=\"item.index\">\r\n                            <h2>{{ item.index }}</h2>\r\n                            <ul class=\"clearfix\">\r\n                                <li v-for=\"itemList in item.list\" :key=\"itemList.id\" @tap=\"handleToCity(itemList.nm , itemList.id)\"><span>{{ itemList.nm }}</span></li>\r\n                            </ul>\r\n                        </div>\t\r\n                    </div>\r\n                </div>\r\n          \r\n        </div>\r\n        <!-- <div class=\"city_index\">\r\n            <ul>\r\n                <li v-for=\"(item,index) in cityList\" :key=\"item.index\" @touchstart=\"handleToIndex(index)\">{{ item.index }}</li>\r\n            </ul>\r\n        </div> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n\r\n    name : 'City',\r\n    data(){\r\n        return {\r\n            cityList : [],\r\n            hotList : [],\r\n            // isLoading : true\r\n        }\r\n    },\r\n    mounted(){\r\n        var cityList = window.localStorage.getItem('cityList');\r\n        var hotList = window.localStorage.getItem('hotList');\r\n\r\n        if(cityList && hotList){\r\n            this.cityList = JSON.parse(cityList);\r\n            this.hotList = JSON.parse(hotList);\r\n            // this.isLoading = false;\r\n        }\r\n        else{\r\n            this.axios.get('/api/cityList').then((res)=>{\r\n                var msg = res.data.msg;\r\n                if(msg === 'ok'){\r\n                    // this.isLoading = false;\r\n                    var cities = res.data.data.cities;\r\n                    //[ { index : 'A' , list : [{ nm : '阿城' , id : 123 }] } ]\r\n                    var { cityList , hotList } = this.formatCityList(cities);\r\n                    this.cityList = cityList;\r\n                    this.hotList = hotList;\r\n                    window.localStorage.setItem('cityList' , JSON.stringify(cityList));\r\n                    window.localStorage.setItem('hotList' , JSON.stringify(hotList));\r\n                }\r\n            });\r\n        }\r\n    },\r\n    methods : {\r\n        formatCityList(cities){\r\n            var cityList = [];\r\n            var hotList = [];\r\n\r\n            for(var i=0;i<cities.length;i++){\r\n                if(cities[i].isHot === 1){\r\n                    hotList.push( cities[i] );\r\n                }\r\n            }\r\n\r\n            for(var i=0;i<cities.length;i++){\r\n                var firstLetter = cities[i].py.substring(0,1).toUpperCase();\r\n                if(toCom(firstLetter)){  //新添加index\r\n                    cityList.push({ index : firstLetter , list : [ { nm : cities[i].nm , id : cities[i].id } ] });\r\n                }\r\n                else{   //累加到已有index中\r\n                    for(var j=0;j<cityList.length;j++){\r\n                        if( cityList[j].index === firstLetter ){\r\n                            cityList[j].list.push( { nm : cities[i].nm , id : cities[i].id } );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            cityList.sort((n1,n2)=>{\r\n                if( n1.index > n2.index ){\r\n                    return 1;\r\n                }\r\n                else if(n1.index < n2.index){\r\n                    return -1;\r\n                }\r\n                else{\r\n                    return 0;\r\n                }\r\n            });\r\n\r\n           \r\n\r\n            function toCom(firstLetter){\r\n                for(var i=0;i<cityList.length;i++){\r\n                    if( cityList[i].index ===  firstLetter){\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            return {\r\n                cityList,\r\n                hotList\r\n            };\r\n\r\n        },\r\n        handleToIndex(index){\r\n            var h2 = this.$refs.city_sort.getElementsByTagName('h2');\r\n            //this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop;\r\n            this.$refs.city_List.toScrollTop(-h2[index].offsetTop);\r\n        },\r\n        handleToCity(nm,id){\r\n            this.$store.commit('city/CITY_INFO',{ nm , id });\r\n            window.localStorage.setItem('nowNm',nm);\r\n            window.localStorage.setItem('nowId',id);\r\n            this.$router.push('/movie/nowPlaying');\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#content .city_body{ margin-top: 45px; display: flex; width:100%; position: absolute; top: 0; bottom: 0;}\r\n.city_body .city_list{ flex:1; overflow: auto; }\r\n.city_body .city_list::-webkit-scrollbar{\r\n    background-color:transparent;\r\n    width:0;\r\n}\r\n.clearfix{\r\n    font-size: 13px;\r\n    overflow: hidden;background: #F0F0F0;padding:0 18px;\r\n}\r\n.clearfix li:nth-of-type(3n+2){\r\n  text-align: center;\r\n}\r\n.clearfix li:nth-of-type(3n) span{\r\n    float: right;\r\n}\r\n#selectCity .clearfix {\r\n    margin-top: 0px;\r\n    background: white;\r\n}\r\n.clearfix li span{\r\n    display: inline-block;\r\n    width: 72px;\r\n    height: 27px;\r\n    border: 1px solid #ddd;\r\n    line-height: 27px;\r\n    border-radius: 3px;\r\n    text-align: center;\r\n}\r\n#selectCity .clearfix li span{\r\n     border: none;\r\n}\r\n.city_body .city_hot{ }\r\n.city_body .city_hot h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0; font-weight: normal;}\r\n.city_body .city_hot ul li{ float: left;  width: 33%; height: 33px;border-radius: 3px; line-height: 33px;box-sizing: border-box;}\r\n.city_body .city_sort div{ }\r\n.city_body .city_sort h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0;font-weight: 600;color: #385c9a;}\r\n.city_body .city_sort ul{  margin-top: 10px;}\r\n.city_body .city_sort ul li{ line-height: 30px; line-height: 30px;font-size: 13px;   }\r\n.city_body .city_index{ width:20px; display: flex; flex-direction:column; justify-content:center; text-align: center; border-left:1px #e6e6e6 solid;}\r\n</style>\r\n"]}]}