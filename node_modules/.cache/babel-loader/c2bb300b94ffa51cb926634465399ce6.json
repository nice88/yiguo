{"remainingRequest":"E:\\vue\\yg2\\yiguo\\node_modules\\babel-loader\\lib\\index.js!E:\\vue\\yg2\\yiguo\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\vue\\yg2\\yiguo\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\vue\\yg2\\yiguo\\src\\components\\home\\city.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\vue\\yg2\\yiguo\\src\\components\\home\\city.vue","mtime":1561468854025},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1561468846106},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\babel-loader\\lib\\index.js","mtime":1561468845863},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1561468846106},{"path":"E:\\vue\\yg2\\yiguo\\node_modules\\vue-loader\\lib\\index.js","mtime":1561468853342}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.sort\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nexport default {\n  name: 'City',\n  data: function data() {\n    return {\n      cityList: [],\n      hotList: [] // isLoading : true\n\n    };\n  },\n  mounted: function mounted() {\n    var _this = this;\n\n    var cityList = window.localStorage.getItem('cityList');\n    var hotList = window.localStorage.getItem('hotList');\n\n    if (cityList && hotList) {\n      this.cityList = JSON.parse(cityList);\n      this.hotList = JSON.parse(hotList); // this.isLoading = false;\n    } else {\n      this.axios.get('/api/cityList').then(function (res) {\n        var msg = res.data.msg;\n\n        if (msg === 'ok') {\n          // this.isLoading = false;\n          var cities = res.data.data.cities; //[ { index : 'A' , list : [{ nm : '阿城' , id : 123 }] } ]\n\n          var _this$formatCityList = _this.formatCityList(cities),\n              cityList = _this$formatCityList.cityList,\n              hotList = _this$formatCityList.hotList;\n\n          _this.cityList = cityList;\n          _this.hotList = hotList;\n          window.localStorage.setItem('cityList', JSON.stringify(cityList));\n          window.localStorage.setItem('hotList', JSON.stringify(hotList));\n        }\n      });\n    }\n  },\n  methods: {\n    formatCityList: function formatCityList(cities) {\n      var cityList = [];\n      var hotList = [];\n\n      for (var i = 0; i < cities.length; i++) {\n        if (cities[i].isHot === 1) {\n          hotList.push(cities[i]);\n        }\n      }\n\n      for (var i = 0; i < cities.length; i++) {\n        var firstLetter = cities[i].py.substring(0, 1).toUpperCase();\n\n        if (toCom(firstLetter)) {\n          //新添加index\n          cityList.push({\n            index: firstLetter,\n            list: [{\n              nm: cities[i].nm,\n              id: cities[i].id\n            }]\n          });\n        } else {\n          //累加到已有index中\n          for (var j = 0; j < cityList.length; j++) {\n            if (cityList[j].index === firstLetter) {\n              cityList[j].list.push({\n                nm: cities[i].nm,\n                id: cities[i].id\n              });\n            }\n          }\n        }\n      }\n\n      cityList.sort(function (n1, n2) {\n        if (n1.index > n2.index) {\n          return 1;\n        } else if (n1.index < n2.index) {\n          return -1;\n        } else {\n          return 0;\n        }\n      });\n\n      function toCom(firstLetter) {\n        for (var i = 0; i < cityList.length; i++) {\n          if (cityList[i].index === firstLetter) {\n            return false;\n          }\n        }\n\n        return true;\n      }\n\n      return {\n        cityList: cityList,\n        hotList: hotList\n      };\n    },\n    handleToIndex: function handleToIndex(index) {\n      var h2 = this.$refs.city_sort.getElementsByTagName('h2'); //this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop;\n\n      this.$refs.city_List.toScrollTop(-h2[index].offsetTop);\n    },\n    handleToCity: function handleToCity(nm, id) {\n      this.$store.commit('city/CITY_INFO', {\n        nm: nm,\n        id: id\n      });\n      window.localStorage.setItem('nowNm', nm);\n      window.localStorage.setItem('nowId', id);\n      this.$router.push('/movie/nowPlaying');\n    }\n  }\n};",{"version":3,"sources":["city.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <div class=\"city_body\">\r\n        <!-- <div class=\"city_list\">\r\n            <div class=\"city_hot\">\r\n                <h2>热门城市</h2>\r\n                <ul class=\"clearfix\">\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                    <li><span>上海</span></li>\r\n                </ul>\r\n            </div>\r\n            <div class=\"city_sort city_hot selectCity\" id=\"selectCity\">\r\n                <div>\r\n                    <h2>A</h2>\r\n                    <ul class=\"clearfix\">\r\n                        <li><span>阿拉善盟</span></li>\r\n                        <li><span>鞍山</span></li>\r\n                        <li><span>安庆</span></li>\r\n                        <li><span>安阳</span></li>\r\n                    </ul>\r\n                </div>\t\r\n            </div>\r\n        </div> -->\r\n        <!-- <div class=\"city_index\">\r\n            <ul>\r\n                <li>A</li>\r\n                <li>B</li>\r\n                <li>C</li>\r\n                <li>D</li>\r\n                <li>E</li>\r\n            </ul>\r\n        </div> -->\r\n   \r\n        <div class=\"city_list\">\r\n            <Loading v-if=\"isLoading\" />\r\n         \r\n                <div>\r\n                    <div class=\"city_hot\">\r\n                        <h2>热门城市</h2>\r\n                        <ul class=\"clearfix\">\r\n                            <li v-for=\"item in hotList\" :key=\"item.id\" @tap=\"handleToCity(item.nm , item.id)\"><span>{{ item.nm }}</span></li>\r\n                        </ul>\r\n                    </div>\r\n                    <div class=\"city_sort city_hot selectCity\" id=\"selectCity\" ref=\"city_sort\">\r\n                        <div v-for=\"item in cityList\" :key=\"item.index\">\r\n                            <h2>{{ item.index }}</h2>\r\n                            <ul class=\"clearfix\">\r\n                                <li v-for=\"itemList in item.list\" :key=\"itemList.id\" @tap=\"handleToCity(itemList.nm , itemList.id)\"><span>{{ itemList.nm }}</span></li>\r\n                            </ul>\r\n                        </div>\t\r\n                    </div>\r\n                </div>\r\n          \r\n        </div>\r\n        <!-- <div class=\"city_index\">\r\n            <ul>\r\n                <li v-for=\"(item,index) in cityList\" :key=\"item.index\" @touchstart=\"handleToIndex(index)\">{{ item.index }}</li>\r\n            </ul>\r\n        </div> -->\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n\r\n    name : 'City',\r\n    data(){\r\n        return {\r\n            cityList : [],\r\n            hotList : [],\r\n            // isLoading : true\r\n        }\r\n    },\r\n    mounted(){\r\n        var cityList = window.localStorage.getItem('cityList');\r\n        var hotList = window.localStorage.getItem('hotList');\r\n\r\n        if(cityList && hotList){\r\n            this.cityList = JSON.parse(cityList);\r\n            this.hotList = JSON.parse(hotList);\r\n            // this.isLoading = false;\r\n        }\r\n        else{\r\n            this.axios.get('/api/cityList').then((res)=>{\r\n                var msg = res.data.msg;\r\n                if(msg === 'ok'){\r\n                    // this.isLoading = false;\r\n                    var cities = res.data.data.cities;\r\n                    //[ { index : 'A' , list : [{ nm : '阿城' , id : 123 }] } ]\r\n                    var { cityList , hotList } = this.formatCityList(cities);\r\n                    this.cityList = cityList;\r\n                    this.hotList = hotList;\r\n                    window.localStorage.setItem('cityList' , JSON.stringify(cityList));\r\n                    window.localStorage.setItem('hotList' , JSON.stringify(hotList));\r\n                }\r\n            });\r\n        }\r\n    },\r\n    methods : {\r\n        formatCityList(cities){\r\n            var cityList = [];\r\n            var hotList = [];\r\n\r\n            for(var i=0;i<cities.length;i++){\r\n                if(cities[i].isHot === 1){\r\n                    hotList.push( cities[i] );\r\n                }\r\n            }\r\n\r\n            for(var i=0;i<cities.length;i++){\r\n                var firstLetter = cities[i].py.substring(0,1).toUpperCase();\r\n                if(toCom(firstLetter)){  //新添加index\r\n                    cityList.push({ index : firstLetter , list : [ { nm : cities[i].nm , id : cities[i].id } ] });\r\n                }\r\n                else{   //累加到已有index中\r\n                    for(var j=0;j<cityList.length;j++){\r\n                        if( cityList[j].index === firstLetter ){\r\n                            cityList[j].list.push( { nm : cities[i].nm , id : cities[i].id } );\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            cityList.sort((n1,n2)=>{\r\n                if( n1.index > n2.index ){\r\n                    return 1;\r\n                }\r\n                else if(n1.index < n2.index){\r\n                    return -1;\r\n                }\r\n                else{\r\n                    return 0;\r\n                }\r\n            });\r\n\r\n           \r\n\r\n            function toCom(firstLetter){\r\n                for(var i=0;i<cityList.length;i++){\r\n                    if( cityList[i].index ===  firstLetter){\r\n                        return false;\r\n                    }\r\n                }\r\n                return true;\r\n            }\r\n\r\n            return {\r\n                cityList,\r\n                hotList\r\n            };\r\n\r\n        },\r\n        handleToIndex(index){\r\n            var h2 = this.$refs.city_sort.getElementsByTagName('h2');\r\n            //this.$refs.city_sort.parentNode.scrollTop = h2[index].offsetTop;\r\n            this.$refs.city_List.toScrollTop(-h2[index].offsetTop);\r\n        },\r\n        handleToCity(nm,id){\r\n            this.$store.commit('city/CITY_INFO',{ nm , id });\r\n            window.localStorage.setItem('nowNm',nm);\r\n            window.localStorage.setItem('nowId',id);\r\n            this.$router.push('/movie/nowPlaying');\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n#content .city_body{ margin-top: 45px; display: flex; width:100%; position: absolute; top: 0; bottom: 0;}\r\n.city_body .city_list{ flex:1; overflow: auto; }\r\n.city_body .city_list::-webkit-scrollbar{\r\n    background-color:transparent;\r\n    width:0;\r\n}\r\n.clearfix{\r\n    font-size: 13px;\r\n    overflow: hidden;background: #F0F0F0;padding:0 18px;\r\n}\r\n.clearfix li:nth-of-type(3n+2){\r\n  text-align: center;\r\n}\r\n.clearfix li:nth-of-type(3n) span{\r\n    float: right;\r\n}\r\n#selectCity .clearfix {\r\n    margin-top: 0px;\r\n    background: white;\r\n}\r\n.clearfix li span{\r\n    display: inline-block;\r\n    width: 72px;\r\n    height: 27px;\r\n    border: 1px solid #ddd;\r\n    line-height: 27px;\r\n    border-radius: 3px;\r\n    text-align: center;\r\n}\r\n#selectCity .clearfix li span{\r\n     border: none;\r\n}\r\n.city_body .city_hot{ }\r\n.city_body .city_hot h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0; font-weight: normal;}\r\n.city_body .city_hot ul li{ float: left;  width: 33%; height: 33px;border-radius: 3px; line-height: 33px;box-sizing: border-box;}\r\n.city_body .city_sort div{ }\r\n.city_body .city_sort h2{ padding-left: 15px; line-height: 30px; font-size: 14px; background:#F0F0F0;font-weight: 600;color: #385c9a;}\r\n.city_body .city_sort ul{  margin-top: 10px;}\r\n.city_body .city_sort ul li{ line-height: 30px; line-height: 30px;font-size: 13px;   }\r\n.city_body .city_index{ width:20px; display: flex; flex-direction:column; justify-content:center; text-align: center; border-left:1px #e6e6e6 solid;}\r\n</style>\r\n"],"sourceRoot":"src/components/home"}]}